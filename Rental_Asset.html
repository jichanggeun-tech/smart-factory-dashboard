<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎåÄÏó¨ÏûêÏÇ∞</title>
    <!-- Dependencies -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dexie/3.2.4/dexie.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        :root {
            --bg-body: #111827;
            --bg-nav: #1f2937;
            --bg-card: #2d3748;
            --bg-input: #374151;
            --text-main: #f9fafb;
            --text-muted: #9ca3af;
            --accent: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --blue: #3b82f6;
            --border: #4b5563;
        }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            overflow: hidden;
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        aside {
            width: 260px;
            background: var(--bg-nav);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 15px;
        }

        .brand {
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            color: var(--blue);
        }

        .nav-item {
            padding: 12px;
            margin-bottom: 5px;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-muted);
        }

        .nav-item:hover,
        .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .project-list {
            flex: 1;
            overflow-y: auto;
            margin-top: 20px;
        }

        .project-item {
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 6px;
            margin-bottom: 2px;
            font-size: 14px;
            color: var(--text-muted);
            display: flex;
            justify-content: space-between;
        }

        .project-item:hover,
        .project-item.active {
            background: var(--bg-input);
            color: white;
        }

        /* Sidebar Controls (Home + Toggle wrapper) */
        /* [ÏàòÏ†ïÎê®] ÌëúÏ§Ä Ìôà Î≤ÑÌäº & ÌÜ†Í∏Ä Î≤ÑÌäº Ïä§ÌÉÄÏùº */
        .sidebar-controls {
            display: flex;
            align-items: center;
            position: fixed;
            top: 15px;
            left: 15px !important;
            z-index: 1001;
            transition: none;
        }

        .home-btn {
            background: #334155 !important;
            color: #e2e8f0 !important;
            border: 1px solid #475569 !important;
            border-radius: 8px 0 0 8px !important;
            /* Îë•Í∑º Ï†ïÎèÑ 8px */
            height: 28px !important;
            /* ÎÜíÏù¥ 28px */
            padding: 0 10px !important;
            box-sizing: border-box !important;
            text-decoration: none !important;
            font-size: 12px !important;
            font-weight: 700 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 4px !important;
            margin: 0 !important;
        }

        .home-btn:hover {
            background: #4285F4 !important;
            color: #fff !important;
        }

        .btn-toggle-sidebar {
            width: 24px !important;
            height: 28px !important;
            /* ÎÜíÏù¥ 28px */
            background: #1e293b !important;
            border: 1px solid #334155 !important;
            border-left: none !important;
            /* ÏôºÏ™Ω ÏÑ† Ï†úÍ±∞ (Ïó∞Í≤∞Ìö®Í≥º) */
            border-radius: 0 8px 8px 0 !important;
            /* Ïò§Î•∏Ï™ΩÎßå Îë•Í∏ÄÍ≤å */
            box-sizing: border-box !important;
            color: #94a3b8 !important;
            cursor: pointer !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-size: 12px !important;
            padding: 0 !important;
        }

        .btn-toggle-sidebar:hover {
            color: white !important;
            background: #334155 !important;
        }

        .btn-toggle-sidebar:hover {
            color: white;
            background: #334155;
        }

        /* Collapsed State */
        body.sidebar-collapsed aside {
            margin-left: -260px;
        }

        body.sidebar-collapsed .sidebar-controls {
            left: 0;
        }

        /* Main Content */
        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        header {
            height: 60px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            background: var(--bg-body);
        }

        .search-bar {
            background: var(--bg-input);
            border-radius: 6px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            width: 300px;
        }

        .search-bar input {
            background: transparent;
            border: none;
            color: white;
            margin-left: 10px;
            width: 100%;
            outline: none;
        }

        .actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn:hover {
            background: #4b5563;
        }

        .btn.primary {
            background: var(--blue);
            color: white;
            border: none;
            font-weight: bold;
        }

        .btn.danger {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
            border-color: var(--danger);
        }

        /* Table */
        .table-container {
            flex: 1;
            overflow: auto;
            padding: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        th {
            text-align: left;
            padding: 12px;
            border-bottom: 2px solid var(--border);
            color: var(--text-muted);
            position: sticky;
            top: 0;
            background: var(--bg-body);
            z-index: 10;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border);
            vertical-align: middle;
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .status-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            display: inline-block;
        }

        .status-use {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent);
        }

        .status-not-use {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .status-returned {
            background: rgba(156, 163, 175, 0.2);
            color: var(--text-muted);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal {
            background: var(--bg-card);
            border-radius: 12px;
            width: 700px;
            max-width: 90vw;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            max-height: 90vh;
        }

        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .input,
        select,
        textarea {
            width: 100%;
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: white;
            padding: 8px;
            border-radius: 6px;
            margin-top: 4px;
            box-sizing: border-box;
            font-family: inherit;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* Shared Report Styles */
        .report-style-base {
            background: white !important;
            color: black !important;
        }

        /* Report Mode (Screen) */
        .report-mode aside,
        .report-mode header,
        .report-mode .no-print {
            display: none !important;
        }

        .report-mode body {
            height: auto;
            display: block;
            background: white !important;
            color: black !important;
            overflow: visible !important;
        }

        .report-mode main {
            overflow: visible !important;
        }

        .report-mode .table-container {
            overflow: visible !important;
            padding: 0 !important;
        }

        .report-mode table {
            font-size: 11px;
            width: 100%;
            border-collapse: collapse;
            color: black !important;
        }

        .report-mode th,
        .report-mode td {
            border: 1px solid #000 !important;
            padding: 4px;
            color: black !important;
            background: white !important;
        }

        .report-mode th {
            background: #eee !important;
        }

        .report-mode .status-badge {
            border: 1px solid #000;
            color: black !important;
            background: transparent !important;
            font-weight: bold;
        }

        /* Print Override */
        /* Print Override */
        @media print {

            aside,
            header,
            .no-print,
            .btn,
            .modal-footer,
            .actions {
                display: none !important;
            }

            body,
            .modal {
                background: white;
                color: black;
                width: 100%;
                height: auto;
                overflow: visible;
                position: static;
            }

            .modal-overlay {
                position: static;
                background: white;
                display: block;
            }

            .modal {
                border: none;
                box-shadow: none;
                max-width: 100%;
                width: 100%;
            }

            th,
            td {
                border: 1px solid #000 !important;
                color: black !important;
            }

            th {
                background: #eee !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .status-badge {
                border: 1px solid #000;
                color: black !important;
                background: transparent !important;
                font-weight: bold;
            }

            /* Hide Main Content if Modal is Open */
            main {
                display: none !important;
            }

            /* But if report modal is NOT open, we might want to print main table? 
               Actually, let's just assume we only print from report modal for now for consistency,
               OR we check if modal is open. 
               The .modal-overlay display:block handles showing the modal.
            */
        }

        /* High Contrast Symbols (Always useful, but critical in report) */
        .sym-use {
            color: #4ade80 !important;
            font-weight: 900;
            font-size: 1.2em;
        }

        .sym-not {
            color: #f87171 !important;
            font-weight: 900;
            font-size: 1.1em;
        }

        .sym-ret {
            color: #94a3b8 !important;
        }
    </style>
</head>

<body>
    <div id="app" style="width:100%; display:flex;">

        <!-- SIDEBAR -->
        <aside>
            <div class="brand">
            </div>

            <!-- Dashboard Button removed as per simplification, or kept if needed. Let's keep it simple first. -->
            <div class="nav-item" :style="{color: isSyncing ? 'var(--warning)' : 'var(--text-muted)'}">
                <i class="fa-solid" :class="isSyncing ? 'fa-spinner fa-spin' : 'fa-cloud'"></i>
                {{ isSyncing ? 'ÎèôÍ∏∞Ìôî Ï§ë (Sincronizando...)' : 'ÎåÄÍ∏∞ (Listo)' }}
            </div>

            <div
                style="font-size:12px; font-weight:bold; margin-top:20px; margin-bottom:10px; color:#666; display:flex; justify-content:space-between;">
                PROJECTS (ÌîÑÎ°úÏ†ùÌä∏)
                <i class="fa-solid fa-plus" style="cursor:pointer; color:var(--blue);" @click="createProject"></i>
            </div>

            <div class="project-list">
                <div class="project-item" v-for="p in projects" :key="p.id"
                    :class="{active: currentProject && currentProject.id === p.id}" @click="selectProject(p)">
                    <span>{{ p.name }}</span>
                    <i class="fa-solid fa-trash" style="font-size:10px; color:#666;" @click.stop="deleteProject(p)"></i>
                </div>
            </div>

            <div style="margin-top:auto; font-size:11px; text-align:center; color:#444;">
                &copy; Antigravity Systems
            </div>

        </aside>

        <div class="sidebar-controls">
            <a class="home-btn" href="index.html">üè† Home</a>
            <button id="btn-toggle-sidebar" class="btn-toggle-sidebar" onclick="toggleSidebar()">‚óÄ</button>
        </div>



        <!-- MAIN -->
        <main>
            <header>
                <div class="search-bar">
                    <i class="fa-solid fa-search" style="color:#666;"></i>
                    <input v-model="searchQuery" placeholder="Í≤ÄÏÉâ (Search / Buscar)...">
                </div>

                <div class="app-title"
                    style="font-size: 20px; font-weight: bold; color: var(--blue); margin-left: 20px;">
                    <i class="fa-solid fa-boxes-stacked"></i> Rental Asset
                </div>

                <!-- Year Selector for Quarterly Status -->
                <div style="margin-left:20px; display:flex; align-items:center; gap:10px;">
                    <button class="btn" @click="selectedYear--"><i class="fa-solid fa-chevron-left"></i></button>
                    <span style="font-weight:bold; font-size:16px; color:var(--text-main);">{{ selectedYear }}ÎÖÑ</span>
                    <button class="btn" @click="selectedYear++"><i class="fa-solid fa-chevron-right"></i></button>
                </div>

                <div class="actions">
                    <button class="btn" @click="syncFromCloud" title="Download Projects"><i
                            class="fa-solid fa-cloud-arrow-down"></i> Î∂àÎü¨Ïò§Í∏∞ (Cargar)</button>
                    <button class="btn" @click="openSaveModal" title="Upload Projects"><i
                            class="fa-solid fa-cloud-arrow-up"></i> Ï†ÄÏû• (Guardar)</button>
                    <div style="width:1px; height:20px; background:var(--border); margin:0 5px;"></div>

                    <button class="btn btn-primary" @click="openReport">
                        <i class="fa-solid fa-chart-line"></i> Î¶¨Ìè¨Ìä∏ (Reporte)
                    </button>

                    <button class="btn primary" @click="openAddModal">
                        <i class="fa-solid fa-plus"></i> ÏûêÏÇ∞ Ï∂îÍ∞Ä (Agregar)
                    </button>

                    <button class="btn" onclick="document.getElementById('xlsx-file-input').click()"
                        title="ÏóëÏÖÄ ÌååÏùº ÏÑ†ÌÉùÌïòÏó¨ Í∞ÄÏ†∏Ïò§Í∏∞"
                        style="background:rgba(16,185,129,0.15); border-color:var(--accent); color:var(--accent);">
                        <i class="fa-solid fa-file-excel"></i> ÏóëÏÖÄ Í∞ÄÏ†∏Ïò§Í∏∞
                    </button>
                    <input id="xlsx-file-input" type="file" accept=".xlsx,.xls" style="display:none"
                        @change="importExcelData">
                    <button class="btn" @click="showDataModal=true" title="Backup/Restore JSON"><i
                            class="fa-solid fa-database"></i></button>
                </div>
            </header>

            <div class="table-container">
                <table v-if="currentProject">
                    <thead>
                        <tr>
                            <th v-for="c in visibleColumns" :key="c.key"
                                :style="{width: c.width + 'px', cursor: c.sortable ? 'pointer' : 'default'}"
                                @click="c.sortable ? sortTable(c.key) : null">
                                {{ c.label }}
                                <i v-if="sortKey === c.key" class="fa-solid"
                                    :class="sortOrder === 1 ? 'fa-sort-up' : 'fa-sort-down'"></i>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="p in filteredParts" :key="p.id">
                            <td v-for="c in visibleColumns" :key="c.key"
                                :style="{textAlign: (['status','action','img','q1','q2','q3','q4'].includes(c.key)?'center':'left')}">

                                <template v-if="c.key === 'img'">
                                    <div style="display:flex; gap:2px; justify-content:center;">
                                        <div v-if="p.img1"
                                            :style="`width:30px; height:30px; background-image:url(${p.img1}); background-size:cover; background-position:center; border-radius:4px; border:1px solid #555; cursor:pointer`"
                                            @click="setModalImage(p.img1)"></div>
                                        <div v-if="p.img2"
                                            :style="`width:30px; height:30px; background-image:url(${p.img2}); background-size:cover; background-position:center; border-radius:4px; border:1px solid #555; cursor:pointer`"
                                            @click="setModalImage(p.img2)"></div>
                                        <span v-if="!p.img1 && !p.img2" style="color:#444;">-</span>
                                    </div>
                                </template>

                                <template v-else-if="c.key === 'category'">
                                    <span style="font-weight:bold; color:var(--blue);">{{ p.category }}</span>
                                </template>

                                <template v-else-if="c.key === 'assetCode'">
                                    <span style="font-family:monospace; font-size:1.1em;">{{ p.assetCode }}</span>
                                </template>

                                <template v-else-if="c.key === 'status'">
                                    <span v-if="p.status === 'ÏÇ¨Ïö©Ï§ë'" class="status-badge status-use">ÏÇ¨Ïö©Ï§ë (En Uso)</span>
                                    <span v-else-if="p.status === 'ÎØ∏ÏÇ¨Ïö©'" class="status-badge status-not-use">ÎØ∏ÏÇ¨Ïö© (No
                                        Uso)</span>
                                    <span v-else-if="p.status === 'Î∞òÎÇ©'" class="status-badge status-returned">Î∞òÎÇ©
                                        (Devuelto)</span>
                                    <span v-else class="status-badge">{{ p.status }}</span>
                                </template>

                                <!-- Quarterly Status Symbols -->
                                <template v-else-if="['q1','q2','q3','q4'].includes(c.key)">
                                    <span :class="getQuarterSymbolClass(p, c.key)">
                                        {{ getQuarterSymbol(p, c.key) }}
                                    </span>
                                </template>

                                <template v-else-if="c.key === 'no'">
                                    {{ filteredParts.indexOf(p) + 1 }}
                                </template>

                                <template v-else-if="c.key === 'history'">
                                    <span style="font-size:0.9em; white-space:pre-wrap;">{{ p.history }}</span>
                                </template>

                                <template v-else-if="c.key === 'action'">
                                    <button type="button"
                                        style="background:none; border:none; padding:0; cursor:pointer; color:var(--text-muted);"
                                        @click.stop="() => editPart(p)">
                                        <i class="fa-solid fa-pen"></i>
                                    </button>
                                </template>

                                <template v-else>
                                    {{ p[c.key] }}
                                </template>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div v-else style="padding:50px; text-align:center; color:var(--text-muted);">
                    <i class="fa-solid fa-folder-open" style="font-size:48px; margin-bottom:20px;"></i>
                    <p>ÏãúÏûëÌïòÎ†§Î©¥ ÌîÑÎ°úÏ†ùÌä∏Î•º ÏÑ†ÌÉùÌïòÍ±∞ÎÇò ÏÉùÏÑ±ÌïòÏÑ∏Ïöî.<br>(Seleccione o cree un proyecto para comenzar.)</p>
                </div>
            </div>
        </main>

        <!-- REPORT MODAL -->
        <div v-if="showReportModal" class="modal-overlay" @click.self="showReportModal=false">
            <div class="modal" id="report-modal"
                style="width:1200px; max-width:98vw; height:90vh; display:flex; flex-direction:column;">
                <div class="modal-header">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <span>üìä ÏûêÏÇ∞ Î∂ÑÍ∏∞Î≥Ñ Î¶¨Ìè¨Ìä∏ (Reporte Trimestral)</span>
                        <span style="font-size:1.2em; color:var(--blue);">{{ selectedYear }}</span>
                    </div>
                    <div class="actions">
                        <button class="btn btn-secondary" @click="captureReport">üì∑ Ï∫°Ï≤ò (Captura)</button>
                        <button class="btn btn-primary" @click="printReport">üñ® PDF Ïù∏ÏáÑ (Imprimir)</button>
                        <i class="fa-solid fa-times" style="cursor:pointer; margin-left:10px;"
                            @click="showReportModal=false"></i>
                    </div>
                </div>
                <div class="modal-body" id="report-print-area"
                    style="background:white; color:black; flex:1; padding:30px;">
                    <h2 style="text-align:center; margin-bottom:5px;">ÏûÑÎåÄ ÏûêÏÇ∞ ÌòÑÌô© Î¶¨Ìè¨Ìä∏ (Reporte de Estado de Activos de
                        Alquiler)</h2>
                    <h4 style="text-align:center; margin-top:0; color:#555;">Project: {{ currentProject?.name }} | Year:
                        {{ selectedYear }}</h4>

                    <table style="width:100%; border-collapse:collapse; border:1px solid #000; font-size:11px;">
                        <thead>
                            <tr style="background:#eee; color:black;">
                                <th style="border:1px solid #000; padding:6px;">No</th>
                                <th style="border:1px solid #000; padding:6px;">Img (ÏÇ¨ÏßÑ)</th>
                                <th style="border:1px solid #000; padding:6px;">Íµ¨Î∂Ñ (Categor√≠a)</th>
                                <th style="border:1px solid #000; padding:6px;">ÏûêÏÇ∞ ÏΩîÎìú (C√≥digo)</th>
                                <th style="border:1px solid #000; padding:6px;">Î™ÖÌåê (Placa)</th>
                                <th style="border:1px solid #000; padding:6px;">ÏÑ§Î™Ö (Descripci√≥n)</th>
                                <th style="border:1px solid #000; padding:6px; text-align:center;">ÏÉÅÌÉú (Estado)</th>

                                <th style="border:1px solid #000; padding:6px; text-align:center; background:#e0f7fa;">
                                    Q1</th>
                                <th style="border:1px solid #000; padding:6px; text-align:center; background:#f3e5f5;">
                                    Q2</th>
                                <th style="border:1px solid #000; padding:6px; text-align:center; background:#fff3e0;">
                                    Q3</th>
                                <th style="border:1px solid #000; padding:6px; text-align:center; background:#f1f8e9;">
                                    Q4</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(p, idx) in filteredParts" :key="p.id">
                                <td style="border:1px solid #ccc; padding:4px; text-align:center;">{{ idx + 1 }}</td>
                                <td style="border:1px solid #ccc; padding:4px; text-align:center;">
                                    <div v-if="p.img1 || p.img2"
                                        :style="`width:40px; height:40px; background-image:url(${p.img1 || p.img2}); background-size:cover; background-position:center; margin:0 auto; border:1px solid #ddd;`">
                                    </div>
                                    <span v-else style="color:#ccc;">-</span>
                                </td>
                                <td style="border:1px solid #ccc; padding:4px;">{{ p.category }}</td>
                                <td
                                    style="border:1px solid #ccc; padding:4px; font-family:monospace; font-weight:bold;">
                                    {{ p.assetCode }}</td>
                                <td style="border:1px solid #ccc; padding:4px;">{{ p.nameplateCode }}</td>
                                <td style="border:1px solid #ccc; padding:4px;">{{ p.description }}</td>

                                <td style="border:1px solid #ccc; padding:4px; text-align:center;">
                                    <span v-if="p.status === 'ÏÇ¨Ïö©Ï§ë'" style="font-weight:bold; color:green;">In Use</span>
                                    <span v-else-if="p.status === 'ÎØ∏ÏÇ¨Ïö©'" style="font-weight:bold; color:orange;">Not
                                        Use</span>
                                    <span v-else-if="p.status === 'Î∞òÎÇ©'" style="color:#888;">Return</span>
                                    <span v-else>{{ p.status }}</span>
                                </td>

                                <!-- Q1 -->
                                <td style="border:1px solid #ccc; padding:4px; text-align:center; background:#e0f7fa;">
                                    <span :style="{fontWeight:'bold', color: getQuarterColor(p, 'q1')}">{{
                                        getQuarterSymbol(p, 'q1') }}</span>
                                </td>
                                <!-- Q2 -->
                                <td style="border:1px solid #ccc; padding:4px; text-align:center; background:#f3e5f5;">
                                    <span :style="{fontWeight:'bold', color: getQuarterColor(p, 'q2')}">{{
                                        getQuarterSymbol(p, 'q2') }}</span>
                                </td>
                                <!-- Q3 -->
                                <td style="border:1px solid #ccc; padding:4px; text-align:center; background:#fff3e0;">
                                    <span :style="{fontWeight:'bold', color: getQuarterColor(p, 'q3')}">{{
                                        getQuarterSymbol(p, 'q3') }}</span>
                                </td>
                                <!-- Q4 -->
                                <td style="border:1px solid #ccc; padding:4px; text-align:center; background:#f1f8e9;">
                                    <span :style="{fontWeight:'bold', color: getQuarterColor(p, 'q4')}">{{
                                        getQuarterSymbol(p, 'q4') }}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div style="margin-top:20px; font-size:10px; text-align:right;">
                        Generated by Rental Asset Manager | {{ new Date().toLocaleString() }}
                    </div>
                </div>
            </div>
        </div>

        <!-- ADD/EDIT MODAL -->
        <div v-if="showPartModal" class="modal-overlay" @click.self="showPartModal=false">
            <div class="modal" style="width:800px;">
                <div class="modal-header">
                    <span>{{ editingPart.id ? 'ÏàòÏ†ï (Editar)' : 'Ï∂îÍ∞Ä (Agregar)' }} Asset</span>
                    <i class="fa-solid fa-times" style="cursor:pointer;" @click="showPartModal=false"></i>
                </div>
                <div class="modal-body">
                    <div style="display:flex; gap:20px;">
                        <!-- Image Upload Area (Dual) -->
                        <div style="flex:0 0 160px; display:flex; flex-direction:column; gap:10px;">
                            <!-- IMG 1 -->
                            <div
                                style="width:160px; height:160px; border:2px dashed var(--border); border-radius:8px; display:flex; align-items:center; justify-content:center; overflow:hidden; position:relative; background:#1f2937;">
                                <img v-if="editingPart.img1" :src="editingPart.img1"
                                    style="width:100%; height:100%; object-fit:contain;">
                                <div
                                    style="position:absolute; top:5px; left:5px; background:rgba(0,0,0,0.6); color:white; padding:2px 6px; border-radius:4px; font-size:10px;">
                                    IMG 1</div>
                                <i v-if="editingPart.img1" class="fa-solid fa-times"
                                    @click.prevent="editingPart.img1=''"
                                    style="position:absolute; top:5px; right:5px; cursor:pointer; background:rgba(0,0,0,0.6); color:white; padding:4px; border-radius:50%;"></i>

                                <input type="file" @change="(e) => handleImageUpload(e, 1)" accept="image/*"
                                    style="position:absolute; inset:0; opacity:0; cursor:pointer;">
                                <div v-if="!editingPart.img1" style="color:#666; text-align:center; font-size:11px;">
                                    Click or Paste<br>(Main)
                                </div>
                            </div>
                            <!-- IMG 2 -->
                            <div
                                style="width:160px; height:160px; border:2px dashed var(--border); border-radius:8px; display:flex; align-items:center; justify-content:center; overflow:hidden; position:relative; background:#1f2937;">
                                <img v-if="editingPart.img2" :src="editingPart.img2"
                                    style="width:100%; height:100%; object-fit:contain;">
                                <div
                                    style="position:absolute; top:5px; left:5px; background:rgba(0,0,0,0.6); color:white; padding:2px 6px; border-radius:4px; font-size:10px;">
                                    IMG 2</div>
                                <i v-if="editingPart.img2" class="fa-solid fa-times"
                                    @click.prevent="editingPart.img2=''"
                                    style="position:absolute; top:5px; right:5px; cursor:pointer; background:rgba(0,0,0,0.6); color:white; padding:4px; border-radius:50%;"></i>

                                <input type="file" @change="(e) => handleImageUpload(e, 2)" accept="image/*"
                                    style="position:absolute; inset:0; opacity:0; cursor:pointer;">
                                <div v-if="!editingPart.img2" style="color:#666; text-align:center; font-size:11px;">
                                    Click or Paste<br>(Sub)
                                </div>
                            </div>
                        </div>

                        <!-- Form Fields -->
                        <div style="flex:1; display:flex; flex-direction:column; gap:10px;">
                            <div class="grid">
                                <div>
                                    <small>Íµ¨Î∂Ñ (Categor√≠a)</small>
                                    <select v-model="editingPart.category" class="input">
                                        <option value="INYECCION">INYECCION</option>
                                        <option value="PRENSAS">PRENSAS</option>
                                        <option value="ESPUMADO">ESPUMADO</option>
                                        <option value="TAMPOGRAFIA">TAMPOGRAFIA</option>
                                        <option value="PINTURA">PINTURA</option>
                                        <option value="CALIDAD">CALIDAD</option>
                                        <option value="NO USO">NO USO</option>
                                        <option value="OTROS">OTROS</option>
                                    </select>
                                </div>
                                <div>
                                    <small>ÌòÑÏû¨ ÏÉÅÌÉú (Estado Actual)</small>
                                    <select v-model="editingPart.status" class="input">
                                        <option value="ÏÇ¨Ïö©Ï§ë">ÏÇ¨Ïö©Ï§ë (In Use)</option>
                                        <option value="ÎØ∏ÏÇ¨Ïö©">ÎØ∏ÏÇ¨Ïö© (Not in Use)</option>
                                        <option value="Î∞òÎÇ©">Î∞òÎÇ© (Returned)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="grid">
                                <div>
                                    <small>ÏûêÏÇ∞ ÏΩîÎìú (C√≥d. Activo)</small>
                                    <input v-model="editingPart.assetCode" class="input" placeholder="ÌïÑÏàò (Requerido)">
                                </div>
                                <div>
                                    <small>Î™ÖÌåê ÏΩîÎìú (C√≥d. Placa)</small>
                                    <input v-model="editingPart.nameplateCode" class="input">
                                </div>
                            </div>

                            <div>
                                <small>ÏÑ§Î™Ö (Descripci√≥n)</small>
                                <textarea v-model="editingPart.description" class="input" rows="3"></textarea>
                            </div>

                            <div>
                                <small>Ïù¥Î†• (Historial)</small>
                                <textarea v-model="editingPart.history" class="input" rows="2"
                                    placeholder="Ïú†ÏßÄÎ≥¥Ïàò ÎòêÎäî ÏúÑÏπò Ïù¥Î†• (Historial de mantenimiento o ubicaci√≥n)..."></textarea>
                            </div>
                            <!-- Quarterly Status Edit -->
                            <div
                                style="background:var(--bg-input); padding:10px; border-radius:6px; border:1px solid var(--border);">
                                <div style="font-weight:bold; margin-bottom:5px; color:var(--accent);">
                                    {{ selectedYear }} Î∂ÑÍ∏∞Î≥Ñ ÏÉÅÌÉú (Estado Trimestral)
                                </div>
                                <div class="grid" style="grid-template-columns: 1fr 1fr 1fr 1fr; gap:5px;">
                                    <div>
                                        <small>Q1</small>
                                        <select v-model="editingQuarterly.q1" class="input" style="font-size:12px;">
                                            <option value="">-</option>
                                            <option value="use">O (Use)</option>
                                            <option value="not">X (Not)</option>
                                            <option value="ret">Return</option>
                                        </select>
                                    </div>
                                    <div>
                                        <small>Q2</small>
                                        <select v-model="editingQuarterly.q2" class="input" style="font-size:12px;">
                                            <option value="">-</option>
                                            <option value="use">O (Use)</option>
                                            <option value="not">X (Not)</option>
                                            <option value="ret">Return</option>
                                        </select>
                                    </div>
                                    <div>
                                        <small>Q3</small>
                                        <select v-model="editingQuarterly.q3" class="input" style="font-size:12px;">
                                            <option value="">-</option>
                                            <option value="use">O (Use)</option>
                                            <option value="not">X (Not)</option>
                                            <option value="ret">Return</option>
                                        </select>
                                    </div>
                                    <div>
                                        <small>Q4</small>
                                        <select v-model="editingQuarterly.q4" class="input" style="font-size:12px;">
                                            <option value="">-</option>
                                            <option value="use">O (Use)</option>
                                            <option value="not">X (Not)</option>
                                            <option value="ret">Return</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modal Footer -->
                <div class="modal-footer">
                    <button v-if="editingPart.id" class="btn danger" style="margin-right:auto;" @click="deletePart">ÏÇ≠Ï†ú
                        (Eliminar)</button>
                    <button class="btn" @click="showPartModal=false">Ï∑®ÏÜå (Cancelar)</button>
                    <button class="btn primary" @click="savePart">Ï†ÄÏû• (Guardar)</button>
                </div>
            </div>
        </div>

        <!-- DATA MODAL -->
        <div v-if="showDataModal" class="modal-overlay" @click.self="showDataModal=false">
            <div class="modal" style="width:400px;">
                <div class="modal-header">Î∞±ÏóÖ Î∞è Î≥µÏõê (Respaldo y Restauraci√≥n) <i class="fa-solid fa-times"
                        style="cursor:pointer;" @click="showDataModal=false"></i></div>
                <div class="modal-body">
                    <div style="margin-bottom:20px;">
                        <h4>1. Î∞±ÏóÖ (Exportar)</h4>
                        <button class="btn primary" style="width:100%;" @click="downloadJsonBackup"><i
                                class="fa-solid fa-download"></i> JSON Îã§Ïö¥Î°úÎìú (Descargar JSON)</button>
                    </div>
                    <div>
                        <h4>2. Î≥µÏõê (Importar)</h4>
                        <button class="btn" style="width:100%; position:relative; overflow:hidden;">
                            <i class="fa-solid fa-upload"></i> ÌååÏùº ÏÑ†ÌÉù (Seleccionar Archivo)
                            <input type="file" accept=".json" @change="uploadJsonRestore"
                                style="position:absolute; inset:0; opacity:0; cursor:pointer;">
                        </button>
                    </div>
                    <div style="margin-top:30px; border-top:1px solid #444; padding-top:20px;">
                        <button class="btn danger" style="width:100%;" @click="clearAllData">
                            <i class="fa-solid fa-trash-can"></i> Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú (Borrar Todo)
                        </button>
                    </div>
                </div>
                <div class="modal-footer"><button class="btn" @click="showDataModal=false">Îã´Í∏∞ (Cerrar)</button></div>
            </div>
        </div>

        <!-- CLOUD MODAL -->
        <div v-if="showCloudModal" class="modal-overlay" @click.self="showCloudModal=false">
            <div class="modal" style="width:420px;">
                <div class="modal-header">ÌÅ¥ÎùºÏö∞Îìú Î∂àÎü¨Ïò§Í∏∞ (Cargar desde Nube) <i class="fa-solid fa-times"
                        style="cursor:pointer;" @click="showCloudModal=false"></i></div>
                <div class="modal-body">
                    <p style="color:var(--text-muted); font-size:12px; margin-bottom:12px;">Î∂àÎü¨Ïò¨ ÌîÑÎ°úÏ†ùÌä∏Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî. Í∏∞Ï°¥ Î°úÏª¨ Îç∞Ïù¥ÌÑ∞Í∞Ä ÎçÆÏñ¥ÏîåÏõåÏßëÎãàÎã§.<br>(Seleccione proyectos a restaurar.)</p>
                    <div style="display:flex; gap:6px; margin-bottom:12px;">
                        <button class="btn" style="font-size:12px; padding:4px 10px;" @click="selectAllLoad(true)">Ï†ÑÏ≤¥ ÏÑ†ÌÉù</button>
                        <button class="btn" style="font-size:12px; padding:4px 10px;" @click="selectAllLoad(false)">Ï†ÑÏ≤¥ Ìï¥Ï†ú</button>
                    </div>
                    <div v-for="p in cloudProjectsList" :key="p.name"
                        style="display:flex; align-items:center; gap:8px; margin-bottom:5px;">
                        <div style="display:flex; align-items:center; gap:10px; flex:1; padding:8px 10px; border-radius:6px; background:var(--bg-input); cursor:pointer;"
                            @click="toggleLoadProject(p.name)">
                            <input type="checkbox" :checked="loadProjectsSelected.includes(p.name)" style="width:16px; height:16px; pointer-events:none;">
                            <i class="fa-solid fa-folder" style="color:var(--blue);"></i>
                            <span style="flex:1;">{{ p.name }}</span>
                            <span style="font-size:11px; color:#888;">({{ p.count }})</span>
                        </div>
                        <button class="btn danger" style="padding:0 10px; flex-shrink:0;" @click.stop="deleteCloudProject(p.name)"
                            title="ÏÇ≠Ï†ú (Eliminar)">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <span style="font-size:12px; color:var(--text-muted); margin-right:auto;">{{ loadProjectsSelected.length }}Í∞ú ÏÑ†ÌÉùÎê®</span>
                    <button class="btn" @click="showCloudModal=false">Ï∑®ÏÜå (Cancelar)</button>
                    <button class="btn primary" @click="loadSelectedProjects" :disabled="!loadProjectsSelected.length || isSyncing">
                        <i class="fa-solid fa-cloud-arrow-down"></i> Î∂àÎü¨Ïò§Í∏∞ (Cargar)
                    </button>
                </div>
            </div>
        </div>

        <!-- CLOUD SAVE SELECT MODAL -->
        <div v-if="showSaveModal" class="modal-overlay" @click.self="showSaveModal=false">
            <div class="modal" style="width:420px;">
                <div class="modal-header">ÌÅ¥ÎùºÏö∞Îìú Ï†ÄÏû• ÏÑ†ÌÉù (Guardar en Nube) <i class="fa-solid fa-times"
                        style="cursor:pointer;" @click="showSaveModal=false"></i></div>
                <div class="modal-body">
                    <p style="color:var(--text-muted); font-size:12px; margin-bottom:12px;">Ï†ÄÏû•Ìï† ÌîÑÎ°úÏ†ùÌä∏Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî. (Seleccione proyectos a guardar.)</p>
                    <div style="display:flex; gap:6px; margin-bottom:12px;">
                        <button class="btn" style="font-size:12px; padding:4px 10px;" @click="selectAllSave(true)">Ï†ÑÏ≤¥ ÏÑ†ÌÉù</button>
                        <button class="btn" style="font-size:12px; padding:4px 10px;" @click="selectAllSave(false)">Ï†ÑÏ≤¥ Ìï¥Ï†ú</button>
                    </div>
                    <div v-for="p in projects" :key="p.id"
                        style="display:flex; align-items:center; gap:10px; margin-bottom:5px; padding:8px 10px; border-radius:6px; background:var(--bg-input); cursor:pointer;"
                        @click="toggleSaveProject(p.id)">
                        <input type="checkbox" :checked="saveProjectsSelected.includes(p.id)" style="width:16px; height:16px; pointer-events:none;">
                        <span style="flex:1;">{{ p.name }}</span>
                    </div>
                </div>
                <div class="modal-footer">
                    <span style="font-size:12px; color:var(--text-muted); margin-right:auto;">{{ saveProjectsSelected.length }}Í∞ú ÏÑ†ÌÉùÎê®</span>
                    <button class="btn" @click="showSaveModal=false">Ï∑®ÏÜå (Cancelar)</button>
                    <button class="btn primary" @click="syncSelectedToCloud" :disabled="!saveProjectsSelected.length || isSyncing">
                        <i class="fa-solid fa-cloud-arrow-up"></i> Ï†ÄÏû• (Guardar)
                    </button>
                </div>
            </div>
        </div>

        <!-- ImageViewer Overlay -->
        <div v-if="zoomedImage" class="modal-overlay" @click="zoomedImage=null">
            <img :src="zoomedImage" style="max-width:90%; max-height:90vh; border-radius:8px; border:2px solid white;">
        </div>

    </div>

    <script>
        const CLOUD_URL = "https://script.google.com/macros/s/AKfycbyQxtAwkMp_KbRBU_xH-NPj6Md_NJAWYAX-BFxyv8z5oGTM3Kf4vrNQhqJRBfc6JNH-/exec";
        const EXCEL_SEED_DATA = { "1. INYECCION": [{ "assetCode": "1500000339", "nameplateCode": "2668", "description": "MAQUINA INYECTORA DE PLASTICO 650 TONS.", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000340", "nameplateCode": "2708", "description": "MAQUINA INYECTORA DE PLASTICO MARCA LS MT", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000341", "nameplateCode": "2665", "description": "MAQUINA INYECTORA DE PLASTICO 550 TONS", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000494", "nameplateCode": "2240", "description": "QUICK MOLD CLAMP/LC16T*8 FOR LGH450M MAQ#24", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000498", "nameplateCode": "2709", "description": "QUICK MOLD CLAMP/LC16T*8 FOR LGH850M", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000499", "nameplateCode": "2339", "description": "QUICK MOLD CLAMP/LC16T*8 FOR LGH650M", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000500", "nameplateCode": "2338", "description": "QUICK MOLD CLAMP/LC16T*8 FOR LGH850M", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000521", "nameplateCode": "2667", "description": "ROBOT YUDO STAR, MODELO SIGMA 1200-2P", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000522", "nameplateCode": "2669", "description": "ROBOT MARCA YUCON - 400, MODELO YUDO STAR SIGMA-15", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000523", "nameplateCode": "2707", "description": "ROBOT MARCA YUCON 400 MODELO YUDO", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000525", "nameplateCode": "2311", "description": "ROBOT MARCA YUDO STAR-YUCON 400", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000620", "nameplateCode": "2310", "description": "MAQUINA INYECTORA DE PLASTICO LS MTRON", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000622", "nameplateCode": "2315", "description": "MAQUINA INYECTORA DE PLASTICO", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000623", "nameplateCode": "2327", "description": "MAQUINA INYECTORA DE PLASTICO", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000696", "nameplateCode": "2326", "description": "ROBOT MARCA HY ROBOTICS, MODELO NEXIA-800 SYCT TD", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000697", "nameplateCode": "2314", "description": "ROBOT MARCA HY ROBOTICS, MODELO NEXIA-800 SYCT-TD", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000699", "nameplateCode": "2309", "description": "ROBOT MARCA HY ROBOTICS, MODELO NEXIA-800 SYC", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000700", "nameplateCode": "2307", "description": "ROBOT MARCA HY ROBOTICS, MODELO NEXIA-800 SYCT", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000741", "nameplateCode": "2316", "description": "MAQUINA INYECTORA DE PLASTICO MARCA", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001121", "nameplateCode": "602", "description": "MAQUINA INYECTORA DE PLASTICO", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001149", "nameplateCode": "2304", "description": "ROBOT MARCA YUDO STAR , MODELO MEGA 1800", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001160", "nameplateCode": "2302", "description": "ROBOT MARCA YUDO STAR YUCON 400, MODELO SIGMA 1500", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001161", "nameplateCode": "2303", "description": "ROBOT MARCA YUDO STAR YUCON 400 MODELO SIGMA 1500", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001782", "nameplateCode": "2308", "description": "MAQUINA INYECTORA DE PLASTICO MARCA LS MTRON", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001810", "nameplateCode": "605", "description": "MAQUINA INYECTORA DE PLASTICO MARCA LS M", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001811", "nameplateCode": "603", "description": "MAQUINA INYECTORA DE PLASTICO MARCA LS M", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001813", "nameplateCode": "609", "description": "MAQUINA INYECTORA DE PLASTICO MARCA LS M", "status": "\uc0ac\uc6a9\uc911", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001814", "nameplateCode": "2710", "description": "ROBOT MARCA YUDO STAR, MODELO SIGMA 1500", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001979", "nameplateCode": "2800", "description": "PAD PRINTER M/C 2 COLORS 1/2", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002284", "nameplateCode": "2716", "description": "MAQUINA DE VAPOR/STEAM MACHINE", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 INYECCION", "img1": "", "img2": "", "history": "", "quarterly": {} }], "2.PRENSAS": [{ "assetCode": "1500000175", "nameplateCode": "967", "description": "HYD PRESS #2 MSHP-300 MOO SONG", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000197", "nameplateCode": "968", "description": "HYD PRESS #3 MSHP-300 MOON SONG", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000219", "nameplateCode": "970", "description": "PRESS B DOUBLE SHEET FEEDER", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000221", "nameplateCode": "969", "description": "PRESS B HYD PRESS #4 MSHP-300 MOON SONG", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000828", "nameplateCode": "966", "description": "PRESS B DOOR PRESS 1", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500000915", "nameplateCode": "", "description": "PRESS B DOOR PRESS TRANSFER", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001725", "nameplateCode": "3314", "description": "PRESS M/C;TMF & FDR DOOR PRESS TRANSF", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000150", "nameplateCode": "4384", "description": "PRENSA #1", "status": "\uc0ac\uc6a9\uc911", "category": "P3  PRESS LINE C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000151", "nameplateCode": "4385", "description": "PRENSA #2", "status": "\uc0ac\uc6a9\uc911", "category": "P3  PRESS LINE C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000152", "nameplateCode": "4386", "description": "PRENSA #3", "status": "\uc0ac\uc6a9\uc911", "category": "P3  PRESS LINE C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000153", "nameplateCode": "4387", "description": "PRENSA #4", "status": "\uc0ac\uc6a9\uc911", "category": "P3  PRESS LINE C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000154", "nameplateCode": "4388", "description": "PRENSA #5", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000155", "nameplateCode": "", "description": "DESTACKER", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000156", "nameplateCode": "4128", "description": "TRANSFER", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000157", "nameplateCode": "4389", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000158", "nameplateCode": "4390", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001888", "nameplateCode": "", "description": "CHILLER", "status": "\uc0ac\uc6a9\uc911", "category": "P3 PRESS LINE B", "img1": "", "img2": "", "history": "", "quarterly": {} }], "3.ESPUMADO": [{ "assetCode": "1500000316", "nameplateCode": "920", "description": "[ESPUMADO DE PUERTA] DRY PARTS01", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CASE ROOM", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001044", "nameplateCode": "2377", "description": "ICE CASE FOAMING SYSTEM(DRY PART)", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CASE ROOM", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002556", "nameplateCode": "2371", "description": "ESTRUCTURA Y PARTES METALICAS MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002558", "nameplateCode": "521", "description": "UNIDAD DE INJECCION MODELO DAON INTECH/CABEZAL", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002559", "nameplateCode": "520", "description": "BANDA SEPARADOR # 1 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002560", "nameplateCode": "2199", "description": "CHILLER, TUBERIA, PANEL ELECTRICO, ISO PARTES, ESP", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002563", "nameplateCode": "996", "description": "BANDA TRANSPORTADORA # 1 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002564", "nameplateCode": "993", "description": "BRAZO ABRIDOR ROBOT MODELO DAON INTECH/OPENER", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002565", "nameplateCode": "994", "description": "BRAZO CERRADOR ROBOT MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002566", "nameplateCode": "997", "description": "BANDA TRANSPORTADORA # 2 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002567", "nameplateCode": "998", "description": "BANDA TRANSPORTADORA # 3 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002568", "nameplateCode": "999", "description": "BANDA TRANSPORTADORA # 4 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002569", "nameplateCode": "2372", "description": "BANDA TRANSPORTADORA # 5 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002570", "nameplateCode": "1000", "description": "BANDA TRANSPORTADORA # 6 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002571", "nameplateCode": "948", "description": "BANDA SEPARADOR # 2 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002572", "nameplateCode": "949", "description": "BANDA SEPARADOR # 3 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002573", "nameplateCode": "950", "description": "BANDA SEPARADOR # 4 MODELO DAON INTECH", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003065", "nameplateCode": "2375", "description": "SISTEMA GENERADOR DE NITROGENO", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004343", "nameplateCode": "3988", "description": "CHILLER DE ENFRIAMIENTO / ALFFIZ / BSCH-A400SDP", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CHILLER PRENSAS B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004344", "nameplateCode": "3989", "description": "CHILLER DE ENFRIAMIENTO / ALFFIZ / BSCH-A400SDP", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CHILLER ESPUMADO A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004397", "nameplateCode": "4048", "description": "TRANSPORTADOR DE BANDA 7000 L / KMCFA", "status": "\uc0ac\uc6a9\uc911", "category": "PRE ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004398", "nameplateCode": "4049", "description": "TRANSPORTADOR DE BANDA 9000L", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004399", "nameplateCode": "4050", "description": "TRANSPORTADOR DE BANDA", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004401", "nameplateCode": "4052", "description": "TRANSPORTADOR DE BANDA 7000L", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004402", "nameplateCode": "4053", "description": "TRANSPORTADOR DE BANDA 9000L", "status": "\uc0ac\uc6a9\uc911", "category": "PRE ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004403", "nameplateCode": "4054", "description": "SISTEMA DE CARGADO UNLOADING", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004404", "nameplateCode": "4080", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004405", "nameplateCode": "4055", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004406", "nameplateCode": "4056", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004407", "nameplateCode": "4057", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004408", "nameplateCode": "4058", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004409", "nameplateCode": "4059", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004410", "nameplateCode": "4060", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004411", "nameplateCode": "4061", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004412", "nameplateCode": "4062", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004413", "nameplateCode": "4063", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004414", "nameplateCode": "4064", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004415", "nameplateCode": "4065", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004416", "nameplateCode": "4066", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004417", "nameplateCode": "4067", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004418", "nameplateCode": "4068", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004419", "nameplateCode": "4069", "description": "ROLLER URETHANE CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004420", "nameplateCode": "4070", "description": "SISTEMA DE CALENTAMIENTO/ENFRIAMIENTO", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004421", "nameplateCode": "4071", "description": "PANEL DE CONTROL SISTEMA CALENTAMIENTO", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004422", "nameplateCode": "4072", "description": "PANEL DE CONTROL CONVEYOR INVERTER", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004423", "nameplateCode": "4073", "description": "MAQUINA PARA INYECCION", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004424", "nameplateCode": "4074", "description": "TANQUE 1000 LITROS", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500004425", "nameplateCode": "4075", "description": "TANQUE 1000 LITROS", "status": "\uc0ac\uc6a9\uc911", "category": "P3  CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001158", "nameplateCode": "5937", "description": "TANQUES DE QUIMICOS POLYOL", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001159", "nameplateCode": "5938", "description": "TANQUES DE QUIMICOS ISOCIANATO", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001160", "nameplateCode": "5935", "description": "CHILLER", "status": "\ubbf8\uc0ac\uc6a9", "category": "P3 CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001161", "nameplateCode": "5936", "description": "PANEL DE CONTROL AREA DE QUIMICOS", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001162", "nameplateCode": "5939", "description": "SISTEMA DE BOMBAS DE QUIMICOS", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CUARTO BOMBAS B & C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001205", "nameplateCode": "5649", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "PRE ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001206", "nameplateCode": "5650", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "PRE ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001207", "nameplateCode": "5651", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "PRE ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001208", "nameplateCode": "5652", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "PRE ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001209", "nameplateCode": "5653", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "PRE ENSAMBLE LH", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001210", "nameplateCode": "5654", "description": "BELT CONVEYOR", "status": "\ubbf8\uc0ac\uc6a9", "category": "P3 SUB ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001211", "nameplateCode": "5655", "description": "BELT CONVEYOR", "status": "\ubbf8\uc0ac\uc6a9", "category": "P3 SUB ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001212", "nameplateCode": "5656", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001213", "nameplateCode": "5657", "description": "DIVERTER BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "ENSAMBLE A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001214", "nameplateCode": "5658", "description": "BELT CONVEYOR", "status": "\ubbf8\uc0ac\uc6a9", "category": "P3 ESPUMADO LINEA C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001217", "nameplateCode": "5788", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO B & C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001218", "nameplateCode": "5805", "description": "LIFTER DOOR INCASE DOWN", "status": "\uc0ac\uc6a9\uc911", "category": "PRE ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001219", "nameplateCode": "5789", "description": "PANEL DE CONTROL DOOR INCASE DOWN LIFTER", "status": "\uc0ac\uc6a9\uc911", "category": "PRE ENSAMBLE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001220", "nameplateCode": "5790", "description": "LIFTER DOOR INCASE DOWN", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001221", "nameplateCode": "5806", "description": "PANEL DE CONTROL DOOR INCASE DOWN LIFTER", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001224", "nameplateCode": "5800", "description": "PANEL DE CONTROL TURN TABLE", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO B & C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001226", "nameplateCode": "5795", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001227", "nameplateCode": "5796", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001228", "nameplateCode": "5797", "description": "BELT CONVEYOR", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA A", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002121", "nameplateCode": "5791", "description": "TURN TABLE", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA B", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002122", "nameplateCode": "6839", "description": "TANQUE DE QUIMICOS POLYOL", "status": "\uc0ac\uc6a9\uc911", "category": "MEZZANINE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002123", "nameplateCode": "6840", "description": "TANQUE DE QUIMICOS ISOCIANATO", "status": "\uc0ac\uc6a9\uc911", "category": "MEZZANINE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002124", "nameplateCode": "6841", "description": "CHILLER", "status": "\uc0ac\uc6a9\uc911", "category": "MEZZANINE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002125", "nameplateCode": "5792", "description": "TURN TABLE", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO LINEA C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002126", "nameplateCode": "6842", "description": "SISTEMA DE BOMBAS", "status": "\uc0ac\uc6a9\uc911", "category": "MEZZANINE", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002127", "nameplateCode": "6848", "description": "CONTROL PANEL", "status": "\uc0ac\uc6a9\uc911", "category": "P3  CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002129", "nameplateCode": "6835", "description": "PANEL DE CONTROL PARA SISTEMA DE ESPUMA #1", "status": "\uc0ac\uc6a9\uc911", "category": "P3  CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002130", "nameplateCode": "6836", "description": "PANEL DE CONTROL PARA SISTEMA DE ESPUMA #2", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002131", "nameplateCode": "6837", "description": "SISTEMA DE BOMBAS PARA ESPUMADO #1", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501002132", "nameplateCode": "6838", "description": "SISTEMA DE BOMBAS PARA ESPUMADO #2", "status": "\uc0ac\uc6a9\uc911", "category": "P3 CUARTO DE BOMBAS", "img1": "", "img2": "", "history": "", "quarterly": {} }], "4.TAMPOGRAFIA": [{ "assetCode": "1500001943", "nameplateCode": "2355", "description": "5 COLOR PAD PRINTER, PAD&JIG", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000828", "nameplateCode": "2078", "description": "VIBRATION WELDER MACHINE(630E)", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501000829", "nameplateCode": "2735", "description": "VIBRATION WELDER MACHINE(630E)", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002102", "nameplateCode": "1384", "description": "Mezclador de tinta (Estractor sorvente)", "status": "\uc0ac\uc6a9\uc911", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002301", "nameplateCode": "2101", "description": "SOLDADORA ULTRASONICA/DAEYOUNG ULTRASONIC", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002312", "nameplateCode": "2076", "description": "MAQ SOLDADORA(ULTRASONIC WELDING)", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002675", "nameplateCode": "1605", "description": "CONVEYOR 90 CMS X 7 MTS LONG EN TAMPOGRAFIA 3PZ", "status": "\uc0ac\uc6a9\uc911", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002717", "nameplateCode": "455", "description": "HORNO AREA TAMPOGRAFIA 1400*1000*340H 10KW", "status": "\uc0ac\uc6a9\uc911", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002718", "nameplateCode": "454", "description": "HORNO AREA TAMPOGRAFIA 980*1000*340H 8KW", "status": "\uc0ac\uc6a9\uc911", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002720", "nameplateCode": "457", "description": "HORNO AREA TAMPOGRAFIA 980*1000*340H 8KW", "status": "\uc0ac\uc6a9\uc911", "category": "P1 TAMPOGRAFIA", "img1": "", "img2": "", "history": "", "quarterly": {} }], "5.PINTURA": [{ "assetCode": "1500003883", "nameplateCode": "2672", "description": "BASE BOOTH", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003884", "nameplateCode": "2673", "description": "CLEAR BOOTH", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003885", "nameplateCode": "2674", "description": "PRIMER BOOTH", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003886", "nameplateCode": "2675", "description": "WIPPING BOOTH", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003887", "nameplateCode": "2676", "description": "PRIMER A.H.U FAN ROOM", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003888", "nameplateCode": "2677", "description": "COLOR A.H.U FAN ROOM", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003889", "nameplateCode": "2678", "description": "CLEAR A.H.U FAN ROOM", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003890", "nameplateCode": "2679", "description": "PAINT SUPPLY ASSY MARCA GRACO", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003891", "nameplateCode": "2680", "description": "PAINT SUPPLY ASSY MARCA GRACO", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003892", "nameplateCode": "2681", "description": "PAINT SUPPLY ASSY MARCA GRACO", "status": "\uc0ac\uc6a9\uc911", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003894", "nameplateCode": "2683", "description": "CLEAR A/C TOWER SYSTEM", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003895", "nameplateCode": "2684", "description": "PRIMER A/C TOWER SYSTEM", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003896", "nameplateCode": "2685", "description": "BASE A/C TOWER SYSTEM", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003897", "nameplateCode": "2686", "description": "AIR SHOWER MACHINE MCA JINAENG MOD. MD-SK2013-01AT", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003898", "nameplateCode": "2687", "description": "AIR SHOWER MACHINE MCA JINAENG MOD. MD-SK2013-01AT", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003899", "nameplateCode": "2688", "description": "PAINTING ROBOT YASKAWA MODEL MPX3500", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003900", "nameplateCode": "2689", "description": "CONTROL PANEL ROBOT PAINT YASKAWA JZRCR-YCS21-P000", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003901", "nameplateCode": "2690", "description": "PAINTING ROBOT YASKAWA MODEL MPX3500", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003902", "nameplateCode": "2691", "description": "CONTROL PANEL ROBOT PAINT YASKAWA JZRCR-YCS21-P000", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003903", "nameplateCode": "2692", "description": "PAINTING ROBOT YASKAWA MODEL MPX3500", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003904", "nameplateCode": "2693", "description": "CONTROL PANEL ROBOT PAINT YASKAWA JZRCR-YCS21-P000", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003907", "nameplateCode": "2696", "description": "PAINT SUPPLY ASSY MARCA GRACO", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003979", "nameplateCode": "2720", "description": "CONTROL PANEL COAT LINE PRINCIPAL", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003980", "nameplateCode": "2721", "description": "CONTROL PANEL WATER RECYCLING PUMPS", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003981", "nameplateCode": "2671", "description": "BOILER HEATER SP-H40", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003982", "nameplateCode": "3902", "description": "SISTEMA DE RECYCLADO DE AGUA", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003983", "nameplateCode": "2788", "description": "CONVEYOR DE PINTADO", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003984", "nameplateCode": "2787", "description": "CONVEYOR DE HORNO", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500003985", "nameplateCode": "2789", "description": "HORNO DE SECADO", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001887", "nameplateCode": "", "description": "TANQUE", "status": "\ubbf8\uc0ac\uc6a9", "category": "P1 PINTURA", "img1": "", "img2": "", "history": "", "quarterly": {} }], "CALIDAD": [{ "assetCode": "1520000001", "nameplateCode": "4122", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1520000002", "nameplateCode": "4125", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1520000004", "nameplateCode": "4118", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1520000005", "nameplateCode": "4120", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1523000001", "nameplateCode": "4193", "description": "CPU", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1523000002", "nameplateCode": "4192", "description": "CPU", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1523000003", "nameplateCode": "4191", "description": "CPU", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1523000004", "nameplateCode": "4190", "description": "CPU", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1523000005", "nameplateCode": "4189", "description": "CPU", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1523000006", "nameplateCode": "4188", "description": "CPU", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2010000342", "nameplateCode": "1091", "description": "JIG REVISION DE MOTOR", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2010000603", "nameplateCode": "3675", "description": "SET API TESTER E IMPRESORA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2010000626", "nameplateCode": "3766", "description": "SET API TESTER E IMPRESORA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2010000683", "nameplateCode": "4083", "description": "JIG GATE PANEL CONTROL / DV7500K", "status": "\ubbf8\uc0ac\uc6a9", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2010000689", "nameplateCode": "4133", "description": "SET API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2010000690", "nameplateCode": "4135", "description": "SET API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000047", "nameplateCode": "4153", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000048", "nameplateCode": "4154", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000049", "nameplateCode": "4155", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000051", "nameplateCode": "4144", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000052", "nameplateCode": "4146", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000054", "nameplateCode": "4148", "description": "SEP API TESTER E IMPRESORA ZEBRA", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000229", "nameplateCode": "5593", "description": "Assembly Jig", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000244", "nameplateCode": "8328", "description": "Assy Ins Partition inspection", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000299", "nameplateCode": "6226", "description": "OUT DOOR PLATE COOLING", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000313", "nameplateCode": "5769", "description": "Cabinet VIP Inspection JIG", "status": "\ubbf8\uc0ac\uc6a9", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000344", "nameplateCode": "6813", "description": "Auto Visual Inspection System", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000382", "nameplateCode": "6251", "description": "COVER MULTI PLATE BENDING MC", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000383", "nameplateCode": "6258", "description": "ASSY-LINEAR GUIDE", "status": "\ubbf8\uc0ac\uc6a9", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000409", "nameplateCode": "8329", "description": "API Integration Tester", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000410", "nameplateCode": "4650", "description": "API Integration Tester", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000414", "nameplateCode": "7352", "description": "API Integration Tester", "status": "\ubbf8\uc0ac\uc6a9", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000416", "nameplateCode": "8330", "description": "API Integration Tester", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000429", "nameplateCode": "6254", "description": "Cap door API Testor", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000431", "nameplateCode": "6252", "description": "Cover Multi REF Printing JIG", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000432", "nameplateCode": "6253", "description": "Cover Multi REF Printing JIG", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000663", "nameplateCode": "8871", "description": "RF8000F Door ACI (Advenced Component Inspector)", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000664", "nameplateCode": "8872", "description": "RF8000F Door ACI (Advenced Component Inspector)", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000665", "nameplateCode": "8873", "description": "RF8000F Door ACI (Advenced Component Inspector)", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000666", "nameplateCode": "8869", "description": "RF8000F Door ACI (Advenced Component Inspector)", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2013000711", "nameplateCode": "8337", "description": "IN DooR, REF(IN,OUT,) (4D)", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "2030000121", "nameplateCode": "2348", "description": "BARCODE PRINTER MCA. ZEBRA MOD. ZT410", "status": "\uc0ac\uc6a9\uc911", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }], "NO USO": [{ "assetCode": "1500002661", "nameplateCode": "1798", "description": "MAQUINA CORTADORA VINIL DE PUERTA DYSS XS-2208FS", "status": "\ubbf8\uc0ac\uc6a9", "category": "BODEGA DE COMPRAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002662", "nameplateCode": "1799", "description": "LOADER PARA MAQUINA CORTADORA VINIL DYSS", "status": "\ubbf8\uc0ac\uc6a9", "category": "BODEGA DE COMPRAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500002663", "nameplateCode": "1797", "description": "UNLOADER PARA MAQUINA CORTADORA VINIL DYSS", "status": "\ubbf8\uc0ac\uc6a9", "category": "BODEGA DE COMPRAS", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001215", "nameplateCode": "5787", "description": "ROBOT ABB", "status": "\ubbf8\uc0ac\uc6a9", "category": "ALMACEN P1", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001216", "nameplateCode": "5660", "description": "BELT CONVEYOR", "status": "\ubbf8\uc0ac\uc6a9", "category": "P3 ESPUMADO LINEA C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001225", "nameplateCode": "5794", "description": "ROBOT ABB", "status": "\uc0ac\uc6a9\uc911", "category": "P3 ESPUMADO B & C", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001229", "nameplateCode": "5798", "description": "BELT CONVEYOR", "status": "\ubbf8\uc0ac\uc6a9", "category": "ALMACEN P3", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001230", "nameplateCode": "6003", "description": "ROBOT ABB", "status": "\ubbf8\uc0ac\uc6a9", "category": "ALMACEN P1", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001231", "nameplateCode": "5659", "description": "DISPOSITIVO DE PESAJE", "status": "\ubbf8\uc0ac\uc6a9", "category": "ALMACEN P1", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001232", "nameplateCode": "5799", "description": "DISPOSITIVO DE PESAJE", "status": "\ubbf8\uc0ac\uc6a9", "category": "ALMACEN P1", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001233", "nameplateCode": "5982", "description": "DISPOSITIVO DE PESAJE", "status": "\ubbf8\uc0ac\uc6a9", "category": "ALMACEN P1", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1500001178", "nameplateCode": "3439", "description": "TORNO, MARCA HWACHEON MACHINERY WORKS,CO.LTD", "status": "\ubbf8\uc0ac\uc6a9", "category": "", "img1": "", "img2": "", "history": "", "quarterly": {} }, { "assetCode": "1501001889", "nameplateCode": "6796", "description": "DK20210916-02/211637191022454/C3942129-Jun2584DHC", "status": "\ubbf8\uc0ac\uc6a9", "category": "ALMACEN P1", "img1": "", "img2": "", "history": "", "quarterly": {} }] };
        const { createApp, ref, computed, reactive, onMounted, onUnmounted, nextTick } = Vue;
        const db = new Dexie('RentalAssetDB');
        db.version(2).stores({
            projects: '++id, name, updated',
            assets: '++id, projectId, category, assetCode, nameplateCode, status'
        }).upgrade(tx => {
            // Version 2 migration if needed, but schema changes are mostly additions
        });

        createApp({
            setup() {
                const projects = ref([]);
                const currentProject = ref(null);
                const projectParts = ref([]);
                const searchQuery = ref("");
                const showPartModal = ref(false);
                const showDataModal = ref(false);
                const showCloudModal = ref(false);
                const showSaveModal = ref(false);
                const saveProjectsSelected = ref([]);
                const isSyncing = ref(false);
                const isImageProcessing = ref(false);
                const zoomedImage = ref(null);
                const sortKey = ref('assetCode');
                const sortOrder = ref(1);
                const showReportModal = ref(false);

                const selectedYear = ref(new Date().getFullYear());

                const cloudProjectsList = ref([]);
                const rawCloudData = ref([]);
                const loadProjectsSelected = ref([]);

                const columns = ref([
                    { key: 'no', label: 'No.', width: 40, visible: true, sortable: false },
                    { key: 'img', label: 'Ïù¥ÎØ∏ÏßÄ (Img)', width: 70, visible: true, sortable: false },
                    { key: 'category', label: 'Íµ¨Î∂Ñ (Cat.)', width: 100, visible: true, sortable: true },
                    { key: 'assetCode', label: 'ÏûêÏÇ∞ ÏΩîÎìú (C√≥digo)', width: 100, visible: true, sortable: true },
                    { key: 'nameplateCode', label: 'Î™ÖÌåê (Placa)', width: 100, visible: true, sortable: true },
                    { key: 'description', label: 'ÏÑ§Î™Ö (Desc.)', width: 150, visible: true, sortable: true },
                    { key: 'status', label: 'ÏÉÅÌÉú (Estado)', width: 80, visible: true, sortable: true },
                    { key: 'q1', label: 'Q1', width: 40, visible: true, sortable: false },
                    { key: 'q2', label: 'Q2', width: 40, visible: true, sortable: false },
                    { key: 'q3', label: 'Q3', width: 40, visible: true, sortable: false },
                    { key: 'q4', label: 'Q4', width: 40, visible: true, sortable: false },
                    { key: 'history', label: 'Ïù¥Î†• (Historial)', width: 150, visible: true, sortable: true },
                    { key: 'action', label: 'Ìé∏Ïßë', width: 50, visible: true, sortable: false },
                ]);

                const visibleColumns = computed(() => columns.value.filter(c => c.visible));

                const defaultPart = {
                    projectId: null,
                    category: 'INYECCION',
                    assetCode: '',
                    nameplateCode: '',
                    description: '',
                    status: 'ÏÇ¨Ïö©Ï§ë',
                    img1: '',
                    img2: '',
                    history: '',
                    quarterly: {} // { "2024": { q1: 'use', q2: 'not' ... } }
                };
                const editingPart = reactive({ ...defaultPart });
                const editingQuarterly = reactive({ q1: '', q2: '', q3: '', q4: '' });

                // --- Global Paste Listener ---
                const handlePaste = (e) => {
                    if (!showPartModal.value) return;
                    const items = (e.clipboardData || e.originalEvent.clipboardData).items;
                    for (let item of items) {
                        if (item.kind === 'file' && item.type.includes('image/')) {
                            e.preventDefault();
                            const blob = item.getAsFile();
                            // If img1 empty, target 1. Else if img2 empty, target 2. Else replace 1.
                            let target = 1;
                            if (editingPart.img1 && !editingPart.img2) target = 2;
                            processImageFile(blob, target);
                            return;
                        }
                    }
                };

                onMounted(async () => {
                    loadProjects();
                    window.addEventListener('paste', handlePaste);
                    const lastId = localStorage.getItem('lastRentalProjectId');
                    if (lastId) {
                        const p = await db.projects.get(parseInt(lastId));
                        if (p) selectProject(p);
                    }
                });

                onUnmounted(() => {
                    window.removeEventListener('paste', handlePaste);
                });


                const filteredParts = computed(() => {
                    let p = projectParts.value;
                    const q = searchQuery.value.toLowerCase();
                    if (q) p = p.filter(x =>
                        (x.assetCode || '').toLowerCase().includes(q) ||
                        (x.nameplateCode || '').toLowerCase().includes(q) ||
                        (x.description || '').toLowerCase().includes(q)
                    );

                    const k = sortKey.value;
                    const o = sortOrder.value;
                    return p.sort((a, b) => {
                        let va = (a[k] || '').toString().toLowerCase();
                        let vb = (b[k] || '').toString().toLowerCase();
                        if (va < vb) return -1 * o;
                        if (va > vb) return 1 * o;
                        return 0;
                    });
                });

                const sortTable = (key) => {
                    if (sortKey.value === key) sortOrder.value *= -1;
                    else { sortKey.value = key; sortOrder.value = 1; }
                };

                // --- Project Management ---
                const loadProjects = async () => { projects.value = await db.projects.toArray(); };
                const createProject = async () => {
                    const n = prompt("ÌîÑÎ°úÏ†ùÌä∏ Ïù¥Î¶Ñ (Nombre del Proyecto):"); if (!n) return;
                    await db.projects.add({ name: n, updated: new Date() });
                    loadProjects();
                };
                const selectProject = async (p) => {
                    currentProject.value = p;
                    projectParts.value = await db.assets.where('projectId').equals(p.id).toArray();
                    localStorage.setItem('lastRentalProjectId', p.id);
                };
                const deleteProject = async (p) => {
                    if (!confirm(`ÌîÑÎ°úÏ†ùÌä∏ '${p.name}' Î∞è Î™®Îì† ÏûêÏÇ∞ÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå? (Delete project and assets?)`)) return;
                    await db.projects.delete(p.id);
                    await db.assets.where('projectId').equals(p.id).delete();
                    if (currentProject.value?.id === p.id) { currentProject.value = null; projectParts.value = []; }
                    loadProjects();
                };

                // --- Part Management ---
                const getCurrentQuarterKey = () => {
                    const month = new Date().getMonth(); // 0-11
                    if (month >= 0 && month <= 2) return 'q1';
                    if (month >= 3 && month <= 5) return 'q2';
                    if (month >= 6 && month <= 8) return 'q3';
                    return 'q4';
                };

                const openAddModal = () => {
                    if (!currentProject.value) return alert("ÌîÑÎ°úÏ†ùÌä∏Î•º Î®ºÏ†Ä ÏÑ†ÌÉùÌïòÏÑ∏Ïöî! (¬°Seleccione un proyecto primero!)");
                    Object.assign(editingPart, { ...defaultPart, projectId: currentProject.value.id, quarterly: {} });

                    // Reset Quarterly edit Proxy
                    editingQuarterly.q1 = ''; editingQuarterly.q2 = ''; editingQuarterly.q3 = ''; editingQuarterly.q4 = '';

                    // Ïã†Í∑ú Ï∂îÍ∞Ä ÏãúÏóêÎèÑ ÌòÑÏû¨ Î∂ÑÍ∏∞Ïóê ÌòÑÏû¨ ÏÉÅÌÉú Ï†úÏïà
                    const currentQ = getCurrentQuarterKey();
                    const statusVal = editingPart.status === 'ÏÇ¨Ïö©Ï§ë' ? 'use' : (editingPart.status === 'ÎØ∏ÏÇ¨Ïö©' ? 'not' : 'ret');
                    editingQuarterly[currentQ] = statusVal;

                    showPartModal.value = true;
                };

                const editPart = (p) => {
                    Object.assign(editingPart, JSON.parse(JSON.stringify(p)));

                    // Migration: If old img exists but new img1 doesn't, move it
                    if (p.img && !editingPart.img1) editingPart.img1 = p.img;
                    if (!editingPart.quarterly) editingPart.quarterly = {};

                    // Load Quarterly Status for current Year
                    const y = selectedYear.value.toString();
                    const qData = editingPart.quarterly[y] || { q1: '', q2: '', q3: '', q4: '' };

                    // ÎßåÏïΩ ÌòÑÏû¨ Î∂ÑÍ∏∞ Îç∞Ïù¥ÌÑ∞Í∞Ä ÎπÑÏñ¥ÏûàÎã§Î©¥, ÌòÑÏû¨ ÏÉÅÌÉúÎ•º Í∏∞Î∞òÏúºÎ°ú Ï¥àÍ∏∞Ìôî Ï†úÏïà
                    const currentQ = getCurrentQuarterKey();
                    const isCurrentYear = new Date().getFullYear() === selectedYear.value;

                    if (isCurrentYear && (!qData[currentQ] || qData[currentQ] === '')) {
                        if (editingPart.status === 'ÏÇ¨Ïö©Ï§ë') qData[currentQ] = 'use';
                        else if (editingPart.status === 'ÎØ∏ÏÇ¨Ïö©') qData[currentQ] = 'not';
                        else if (editingPart.status === 'Î∞òÎÇ©') qData[currentQ] = 'ret';
                    }

                    Object.assign(editingQuarterly, qData);

                    showPartModal.value = true;
                };

                const savePart = async () => {
                    if (isImageProcessing.value) return alert("Ïù¥ÎØ∏ÏßÄ Ï≤òÎ¶¨ Ï§ë... (Procesando imagen...)");
                    if (!editingPart.assetCode) return alert("ÏûêÏÇ∞ ÏΩîÎìúÎäî ÌïÑÏàòÏûÖÎãàÎã§! (Asset Code Required!)");

                    const copy = JSON.parse(JSON.stringify(editingPart));

                    // Save Quarterly Data
                    const y = selectedYear.value.toString();
                    if (!copy.quarterly) copy.quarterly = {};

                    // ÌòÑÏû¨ Î∂ÑÍ∏∞ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûÖÎ†•ÎêòÏßÄ ÏïäÏïòÎã§Î©¥ ÌòÑÏû¨ ÏÉÅÌÉúÎ•º ÏûêÎèôÏúºÎ°ú Í∏∞Î°ù
                    const currentQ = getCurrentQuarterKey();
                    const isCurrentYear = new Date().getFullYear() === selectedYear.value;
                    if (isCurrentYear && (!editingQuarterly[currentQ] || editingQuarterly[currentQ] === '')) {
                        if (copy.status === 'ÏÇ¨Ïö©Ï§ë') editingQuarterly[currentQ] = 'use';
                        else if (copy.status === 'ÎØ∏ÏÇ¨Ïö©') editingQuarterly[currentQ] = 'not';
                        else if (copy.status === 'Î∞òÎÇ©') editingQuarterly[currentQ] = 'ret';
                    }

                    copy.quarterly[y] = { ...editingQuarterly };

                    if (copy.id) {
                        projectParts.value = projectParts.value.map(p => p.id === copy.id ? copy : p);
                        await db.assets.put(copy);
                    } else {
                        const id = await db.assets.add(copy);
                        copy.id = id;
                        projectParts.value.push(copy);
                    }
                    showPartModal.value = false;
                };

                const deletePart = async () => {
                    if (!confirm("Ïù¥ ÏûêÏÇ∞ÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå? (Delete this asset?)")) return;
                    await db.assets.delete(editingPart.id);
                    projectParts.value = projectParts.value.filter(p => p.id !== editingPart.id);
                    showPartModal.value = false;
                };

                // --- Image Logic ---
                const handleImageUpload = (e, targetNum) => {
                    const f = e.target.files[0]; if (!f) return;
                    processImageFile(f, targetNum);
                };

                const processImageFile = (file, targetNum) => {
                    isImageProcessing.value = true;
                    const r = new FileReader();
                    r.onload = (ev) => {
                        const img = new Image();
                        img.onload = () => {
                            const c = document.createElement('canvas');
                            const MAX_SIZE = 800;
                            let width = img.width;
                            let height = img.height;

                            if (width > height) {
                                if (width > MAX_SIZE) { height *= MAX_SIZE / width; width = MAX_SIZE; }
                            } else {
                                if (height > MAX_SIZE) { width *= MAX_SIZE / height; height = MAX_SIZE; }
                            }

                            c.width = width;
                            c.height = height;
                            c.getContext('2d').drawImage(img, 0, 0, width, height);

                            const dataUrl = c.toDataURL('image/jpeg', 0.7);
                            if (targetNum === 1) editingPart.img1 = dataUrl;
                            else editingPart.img2 = dataUrl;

                            isImageProcessing.value = false;
                        };
                        img.src = ev.target.result;
                    };
                    r.readAsDataURL(file);
                };

                const setModalImage = (src) => { zoomedImage.value = src; }

                // Íµ¨Í∏Ä ÏãúÌä∏ ÏÖÄ ÌïúÎèÑ(50,000Ïûê) ÎÇ¥Î°ú Ïù¥ÎØ∏ÏßÄ ÏûêÎèô ÏïïÏ∂ï
                const compressImageForCloud = (dataUrl, maxChars = 18000) => {
                    if (!dataUrl || dataUrl.length <= maxChars) return Promise.resolve(dataUrl);
                    return new Promise((resolve) => {
                        const img = new Image();
                        img.onerror = () => resolve(''); // Ïù¥ÎØ∏ÏßÄ Î°úÎìú Ïã§Ìå®Ïãú Îπà Î¨∏ÏûêÏó¥ Î∞òÌôò
                        img.onload = () => {
                            const steps = [
                                { size: 500, quality: 0.5 },
                                { size: 350, quality: 0.4 },
                                { size: 250, quality: 0.3 },
                                { size: 180, quality: 0.3 },
                                { size: 120, quality: 0.2 },
                                { size: 80,  quality: 0.2 },
                            ];
                            for (const { size, quality } of steps) {
                                const c = document.createElement('canvas');
                                const ratio = Math.min(size / img.width, size / img.height, 1);
                                c.width = Math.round(img.width * ratio);
                                c.height = Math.round(img.height * ratio);
                                c.getContext('2d').drawImage(img, 0, 0, c.width, c.height);
                                const result = c.toDataURL('image/jpeg', quality);
                                if (result.length <= maxChars) { resolve(result); return; }
                            }
                            // ÏµúÌõÑ ÏàòÎã®: 60x60 ÏµúÏ†ÄÌôîÏßà
                            const c = document.createElement('canvas');
                            c.width = 60; c.height = 60;
                            c.getContext('2d').drawImage(img, 0, 0, 60, 60);
                            resolve(c.toDataURL('image/jpeg', 0.1));
                        };
                        img.src = dataUrl;
                    });
                };

                // --- Report & Util ---
                const openReport = () => { showReportModal.value = true; };

                const getQuarterSymbol = (p, qKey) => {
                    const y = selectedYear.value.toString();
                    let val = (p.quarterly && p.quarterly[y]) ? p.quarterly[y][qKey] : '';

                    // Ìï¥Îãπ Î∂ÑÍ∏∞ Îç∞Ïù¥ÌÑ∞Í∞Ä ÎπÑÏñ¥ÏûàÍ≥†, 'ÌòÑÏû¨ Î∂ÑÍ∏∞'ÎùºÎ©¥ ÌòÑÏû¨ ÏÉÅÌÉúÎ•º Í∏∞Î∞òÏúºÎ°ú ÎØ∏Î¶¨Î≥¥Í∏∞
                    const currentQ = getCurrentQuarterKey();
                    const isCurrentYear = new Date().getFullYear() === selectedYear.value;

                    if (isCurrentYear && qKey === currentQ && (!val || val === '')) {
                        if (p.status === 'ÏÇ¨Ïö©Ï§ë') val = 'use';
                        else if (p.status === 'ÎØ∏ÏÇ¨Ïö©') val = 'not';
                        else if (p.status === 'Î∞òÎÇ©') val = 'ret';
                    }

                    if (val === 'use') return '‚óã';
                    if (val === 'not') return 'X';
                    if (val === 'ret') return 'Return';
                    return '-';
                };

                const getQuarterColor = (p, qKey) => {
                    const y = selectedYear.value.toString();
                    let val = (p.quarterly && p.quarterly[y]) ? p.quarterly[y][qKey] : '';

                    const currentQ = getCurrentQuarterKey();
                    const isCurrentYear = new Date().getFullYear() === selectedYear.value;

                    if (isCurrentYear && qKey === currentQ && (!val || val === '')) {
                        if (p.status === 'ÏÇ¨Ïö©Ï§ë') val = 'use';
                        else if (p.status === 'ÎØ∏ÏÇ¨Ïö©') val = 'not';
                        else if (p.status === 'Î∞òÎÇ©') val = 'ret';
                    }

                    if (val === 'use') return '#4ade80';
                    if (val === 'not') return '#f87171';
                    if (val === 'ret') return 'gray';
                    return '#ccc';
                };

                const getQuarterSymbolClass = (p, qKey) => {
                    const y = selectedYear.value.toString();
                    let val = (p.quarterly && p.quarterly[y]) ? p.quarterly[y][qKey] : '';

                    const currentQ = getCurrentQuarterKey();
                    const isCurrentYear = new Date().getFullYear() === selectedYear.value;

                    if (isCurrentYear && qKey === currentQ && (!val || val === '')) {
                        if (p.status === 'ÏÇ¨Ïö©Ï§ë') val = 'use';
                        else if (p.status === 'ÎØ∏ÏÇ¨Ïö©') val = 'not';
                        else if (p.status === 'Î∞òÎÇ©') val = 'ret';
                    }

                    if (val === 'use') return 'sym-use text-green-500';
                    if (val === 'not') return 'sym-not text-orange-500';
                    if (val === 'ret') return 'sym-ret text-gray-500';
                    return '';
                };

                // --- Cloud Logic ---
                // Îã®Ïùº ÌîÑÎ°úÏ†ùÌä∏Î•º ÌÅ¥ÎùºÏö∞ÎìúÏóê Ï†ÄÏû•ÌïòÎäî Ìó¨Ìçº
                const saveOneProjectToCloud = async (proj) => {
                    const batchId = Date.now();
                    const parts = await db.assets.where('projectId').equals(proj.id).toArray();
                    let partsToSend;

                    if (parts.length === 0) {
                        partsToSend = [{ project: proj.name, batchId, assetCode: 'EMPTY_PROJECT_MARKER', isMarker: true }];
                    } else {
                        partsToSend = await Promise.all(parts.map(async p => {
                            const { img1, img2, ...rest } = p;
                            const cImg1 = img1 ? await compressImageForCloud(img1) : '';
                            const cImg2 = img2 ? await compressImageForCloud(img2) : '';
                            return {
                                ...rest,
                                ...(cImg1 ? { img1: cImg1 } : {}),
                                ...(cImg2 ? { img2: cImg2 } : {}),
                                project: proj.name,
                                batchId
                            };
                        }));
                    }

                    const r = await fetch(CLOUD_URL, {
                        method: 'POST',
                        redirect: 'follow',
                        body: JSON.stringify({ action: 'save', project: proj.name, parts: partsToSend })
                    });
                    const res = await r.json();
                    if (res.result === 'error') throw new Error(res.message);
                    return partsToSend.length;
                };

                // ÌòÑÏû¨ ÌîÑÎ°úÏ†ùÌä∏ Ï†ÄÏû• (Í∏∞Ï°¥ Ìò∏Ìôò)
                const syncToCloud = async () => {
                    if (!currentProject.value) return alert("ÌîÑÎ°úÏ†ùÌä∏Î•º Î®ºÏ†Ä ÏÑ†ÌÉùÌïòÏÑ∏Ïöî!");
                    if (!confirm("ÌÅ¥ÎùºÏö∞ÎìúÏóê Ï†ÄÏû•ÌïòÏãúÍ≤†ÏäµÎãàÍπå?\nSave to Cloud? (Overwrite)")) return;
                    isSyncing.value = true;
                    try {
                        const count = await saveOneProjectToCloud(currentProject.value);
                        alert(`Ï†ÄÏû• ÏôÑÎ£å! (Guardado!) (${count} items)`);
                    } catch (e) { alert("Error: " + e); } finally { isSyncing.value = false; }
                };

                // ÌîÑÎ°úÏ†ùÌä∏ ÏÑ†ÌÉù Î™®Îã¨ Ïó¥Í∏∞
                const openSaveModal = () => {
                    saveProjectsSelected.value = projects.value.map(p => p.id); // Í∏∞Î≥∏: Ï†ÑÏ≤¥ ÏÑ†ÌÉù
                    showSaveModal.value = true;
                };

                const toggleSaveProject = (id) => {
                    const idx = saveProjectsSelected.value.indexOf(id);
                    if (idx >= 0) saveProjectsSelected.value.splice(idx, 1);
                    else saveProjectsSelected.value.push(id);
                };

                const selectAllSave = (val) => {
                    saveProjectsSelected.value = val ? projects.value.map(p => p.id) : [];
                };

                // ÏÑ†ÌÉùÎêú ÌîÑÎ°úÏ†ùÌä∏ Ï†ÑÏ≤¥ Ï†ÄÏû•
                const syncSelectedToCloud = async () => {
                    const selected = projects.value.filter(p => saveProjectsSelected.value.includes(p.id));
                    if (!selected.length) return;
                    if (!confirm(`${selected.length}Í∞ú ÌîÑÎ°úÏ†ùÌä∏Î•º ÌÅ¥ÎùºÏö∞ÎìúÏóê Ï†ÄÏû•ÌïòÏãúÍ≤†ÏäµÎãàÍπå? (Overwrite)`)) return;
                    isSyncing.value = true;
                    showSaveModal.value = false;
                    try {
                        let totalItems = 0;
                        for (const proj of selected) {
                            totalItems += await saveOneProjectToCloud(proj);
                        }
                        alert(`Ï†ÄÏû• ÏôÑÎ£å! (${selected.length}Í∞ú ÌîÑÎ°úÏ†ùÌä∏, ${totalItems} Ìï≠Î™©)`);
                    } catch (e) { alert("Error: " + e); } finally { isSyncing.value = false; }
                };

                const syncFromCloud = async () => {
                    isSyncing.value = true;
                    try {
                        const r = await fetch(CLOUD_URL + "?action=load", {
                            method: "GET",
                            redirect: "follow"
                        });
                        if (!r.ok) throw new Error("HTTP error: " + r.status);

                        const d = await r.json();
                        if (!d || !d.parts || d.parts.length === 0) return alert("ÌÅ¥ÎùºÏö∞ÎìúÏóê Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§. (No data in cloud.)");

                        rawCloudData.value = d.parts;

                        const counts = {};
                        d.parts.forEach(p => {
                            const name = (p.project || 'Unknown').trim();
                            counts[name] = (counts[name] || 0) + 1;
                        });

                        cloudProjectsList.value = Object.keys(counts).map(name => ({
                            name: name,
                            count: counts[name]
                        })).sort((a, b) => b.count - a.count);

                        // Í∏∞Î≥∏: Ï†ÑÏ≤¥ ÏÑ†ÌÉù
                        loadProjectsSelected.value = cloudProjectsList.value.map(p => p.name);
                        showCloudModal.value = true;
                    } catch (e) { alert("Error: " + e); } finally { isSyncing.value = false; }
                };

                // Îã®Ïùº ÌîÑÎ°úÏ†ùÌä∏ Î°úÎìú Ìó¨Ìçº (confirm/alert ÏóÜÏù¥ ÏàúÏàò Î°úÏßÅ)
                const loadOneProjectFromCloud = async (pName) => {
                    let targetProj = projects.value.find(p => p.name === pName);
                    if (!targetProj) {
                        const id = await db.projects.add({ name: pName, updated: new Date() });
                        await loadProjects();
                        targetProj = projects.value.find(p => p.id === id);
                    }

                    const cloudParts = JSON.parse(JSON.stringify(rawCloudData.value.filter(p => (p.project || 'Unknown') === pName)));
                    if (cloudParts.length === 0) return 0;

                    const latestBatchId = cloudParts.reduce((max, p) => Math.max(max, p.batchId || 0), 0);
                    let latestParts = cloudParts.filter(p => (p.batchId || 0) === latestBatchId);
                    latestParts = latestParts.filter(p => !p.isMarker && p.assetCode !== 'EMPTY_PROJECT_MARKER');

                    await db.assets.where('projectId').equals(targetProj.id).delete();

                    if (latestParts.length > 0) {
                        const toAdd = latestParts.map(p => {
                            const { id, project, batchId, _syncId, ...rest } = p;
                            return { ...rest, projectId: Number(targetProj.id) };
                        });
                        await db.assets.bulkAdd(JSON.parse(JSON.stringify(toAdd)));
                    }

                    // ÌòÑÏû¨ ÏÑ†ÌÉù ÌîÑÎ°úÏ†ùÌä∏Î©¥ ÌôîÎ©¥ Í∞±Ïã†
                    if (currentProject.value?.id === targetProj.id) {
                        projectParts.value = await db.assets.where('projectId').equals(targetProj.id).toArray();
                    }
                    return latestParts.length;
                };

                // Í∏∞Ï°¥ Îã®Í±¥ Î°úÎìú (Ìò∏Ìôò)
                const loadSelectedCloudProject = async (pName) => {
                    if (!confirm(`'${pName}' ÌîÑÎ°úÏ†ùÌä∏Î•º Î∂àÎü¨Ïò§ÏãúÍ≤†ÏäµÎãàÍπå? Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞Í∞Ä ÎçÆÏñ¥ÏîåÏõåÏßëÎãàÎã§.`)) return;
                    isSyncing.value = true;
                    try {
                        const count = await loadOneProjectFromCloud(pName);
                        await selectProject(projects.value.find(p => p.name === pName));
                        alert(`Î°úÎìú ÏôÑÎ£å. ('${pName}' Loaded. ${count} items)`);
                        showCloudModal.value = false;
                    } catch (e) { alert("Error: " + e); } finally { isSyncing.value = false; }
                };

                const toggleLoadProject = (name) => {
                    const idx = loadProjectsSelected.value.indexOf(name);
                    if (idx >= 0) loadProjectsSelected.value.splice(idx, 1);
                    else loadProjectsSelected.value.push(name);
                };

                const selectAllLoad = (val) => {
                    loadProjectsSelected.value = val ? cloudProjectsList.value.map(p => p.name) : [];
                };

                // ÏÑ†ÌÉùÎêú ÌîÑÎ°úÏ†ùÌä∏ Ï†ÑÏ≤¥ Î∂àÎü¨Ïò§Í∏∞
                const loadSelectedProjects = async () => {
                    const names = [...loadProjectsSelected.value];
                    if (!names.length) return;
                    if (!confirm(`${names.length}Í∞ú ÌîÑÎ°úÏ†ùÌä∏Î•º Î∂àÎü¨Ïò§ÏãúÍ≤†ÏäµÎãàÍπå? Í∏∞Ï°¥ Î°úÏª¨ Îç∞Ïù¥ÌÑ∞Í∞Ä ÎçÆÏñ¥ÏîåÏõåÏßëÎãàÎã§.`)) return;
                    isSyncing.value = true;
                    showCloudModal.value = false;
                    try {
                        let totalItems = 0;
                        for (const name of names) {
                            totalItems += await loadOneProjectFromCloud(name);
                        }
                        await loadProjects();
                        alert(`Î°úÎìú ÏôÑÎ£å! (${names.length}Í∞ú ÌîÑÎ°úÏ†ùÌä∏, ${totalItems} Ìï≠Î™©)`);
                    } catch (e) { alert("Error: " + e); } finally { isSyncing.value = false; }
                };

                const deleteCloudProject = async (pName) => {
                    if (!confirm(`ÌÅ¥ÎùºÏö∞ÎìúÏóêÏÑú ÏòÅÍµ¨ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå? (Delete '${pName}' permanently?)`)) return;
                    isSyncing.value = true;
                    try {
                        const r = await fetch(CLOUD_URL, {
                            method: 'POST',
                            body: JSON.stringify({ action: 'save', project: pName, parts: [] })
                        });
                        const res = await r.json();
                        if (res.result === 'error') throw new Error(res.message);
                        alert("ÌÅ¥ÎùºÏö∞ÎìúÏóêÏÑú ÏÇ≠Ï†úÎê®. (Deleted from Cloud.)");
                        await syncFromCloud();
                    } catch (e) { alert("Error: " + e); isSyncing.value = false; }
                };


                // --- Backup/Restore ---
                const downloadJsonBackup = () => {
                    db.transaction('r', db.projects, db.assets, async () => {
                        const allProjects = await db.projects.toArray();
                        const allAssets = await db.assets.toArray();
                        const data = { projects: allProjects, assets: allAssets };
                        const blob = new Blob([JSON.stringify(data)], { type: "application/json" });
                        const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
                        a.download = `RentalHelper_${new Date().toISOString().slice(0, 10)}.json`; a.click();
                    });
                };

                const uploadJsonRestore = (e) => {
                    const f = e.target.files[0]; if (!f) return;
                    const r = new FileReader();
                    r.onload = async (ev) => {
                        try {
                            const d = JSON.parse(ev.target.result);
                            if (confirm("Î≥µÏõêÌïòÎ©¥ Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏßÄÏõåÏßëÎãàÎã§. Í≥ÑÏÜçÌïòÏãúÍ≤†ÏäµÎãàÍπå? (Restore will WIPE all data. Continue?)")) {
                                await db.projects.clear(); await db.assets.clear();
                                if (d.projects) await db.projects.bulkAdd(d.projects);
                                if (d.assets) await db.assets.bulkAdd(d.assets);
                                location.reload();
                            }
                        } catch (er) { alert("Invalid File"); }
                    }; r.readAsText(f);
                };

                const clearAllData = async () => {
                    if (confirm("Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå? (Delete ALL data? Irreversible!)")) {
                        await db.projects.clear();
                        await db.assets.clear();
                        localStorage.clear();
                        window.location.reload();
                    }
                }

                onMounted(async () => {
                    await loadProjects();
                    const lastId = localStorage.getItem('lastRentalProjectId');
                    if (lastId) {
                        const p = await db.projects.get(parseInt(lastId));
                        if (p) selectProject(p);
                    }
                });

                const importExcelData = async (event) => {
                    const file = event.target.files[0];
                    event.target.value = '';
                    if (!file) return;
                    if (!confirm('ÏóëÏÖÄ ÌååÏùºÏùÑ Í∞ÄÏ†∏Ïò§Î©¥ ÎèôÏùºÌïú Ïù¥Î¶ÑÏùò ÌîÑÎ°úÏ†ùÌä∏ Îç∞Ïù¥ÌÑ∞Í∞Ä ÎçÆÏñ¥Ïì∞Ïó¨ÏßëÎãàÎã§. Í≥ÑÏÜçÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;

                    const arrayBuffer = await file.arrayBuffer();
                    const workbook = XLSX.read(arrayBuffer, { type: 'array', cellDates: true });

                    let totalProjects = 0, totalAssets = 0;

                    for (const sheetName of workbook.SheetNames) {
                        const sheet = workbook.Sheets[sheetName];
                        const rows = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: '' });

                        // Ìó§Îçî Ìñâ ÌÉêÏÉâ (Activo + Placa Ïª¨ÎüºÏù¥ ÏûàÎäî Ìñâ)
                        let headerIdx = -1, colActivo, colPlaca, colDesc, colEstatus, colUbic;
                        for (let i = 0; i < rows.length; i++) {
                            const row = rows[i].map(c => String(c).trim());
                            if (row.includes('Activo') && row.includes('Placa')) {
                                headerIdx = i;
                                colActivo = row.indexOf('Activo');
                                colPlaca = row.indexOf('Placa');
                                colDesc = row.indexOf('Desc.');
                                colEstatus = row.findIndex(c => c === 'Estatus Mayo');
                                colUbic = row.findIndex(c => c.toLowerCase().includes('ubicaci'));
                                break;
                            }
                        }
                        if (headerIdx === -1) continue;

                        const assets = [];
                        for (let i = headerIdx + 1; i < rows.length; i++) {
                            const row = rows[i];
                            const activo = String(row[colActivo] ?? '').trim();
                            if (!activo) continue;

                            const estatus = String(row[colEstatus] ?? '').trim();
                            let status = 'ÎØ∏ÏÇ¨Ïö©';
                            if (estatus.includes('In Use')) status = 'ÏÇ¨Ïö©Ï§ë';
                            else if (estatus.includes('Return') || estatus.includes('Devuelto')) status = 'Î∞òÎÇ©';

                            assets.push({
                                assetCode: activo,
                                nameplateCode: String(row[colPlaca] ?? '').trim(),
                                description: String(row[colDesc] ?? '').trim(),
                                status,
                                category: colUbic >= 0 ? String(row[colUbic] ?? '').trim() : '',
                                img1: '', img2: '', history: '', quarterly: {}
                            });
                        }
                        if (assets.length === 0) continue;

                        let proj = projects.value.find(p => p.name === sheetName);
                        if (!proj) {
                            const id = await db.projects.add({ name: sheetName, updated: new Date() });
                            await loadProjects();
                            proj = projects.value.find(p => p.id === id);
                        } else {
                            await db.assets.where('projectId').equals(proj.id).delete();
                        }
                        const toAdd = assets.map(a => ({ ...a, projectId: Number(proj.id) }));
                        await db.assets.bulkAdd(JSON.parse(JSON.stringify(toAdd)));
                        totalProjects++;
                        totalAssets += assets.length;
                    }

                    await loadProjects();
                    alert('ÏôÑÎ£å! ' + totalProjects + 'Í∞ú ÌîÑÎ°úÏ†ùÌä∏, ' + totalAssets + 'Í∞ú ÏûêÏÇ∞ Í∞ÄÏ†∏Ïò§Í∏∞ ÏôÑÎ£å.');
                };

                return {
                    projects, currentProject, filteredParts, searchQuery,
                    showPartModal, showDataModal, isSyncing, isImageProcessing,
                    editingPart, zoomedImage, visibleColumns, sortKey, sortOrder,
                    showCloudModal, cloudProjectsList, loadProjectsSelected, selectedYear, editingQuarterly,
                    showReportModal,
                    showSaveModal, saveProjectsSelected,
                    createProject, selectProject, deleteProject,
                    openAddModal, editPart, savePart, deletePart,
                    handleImageUpload, setModalImage, sortTable, getQuarterSymbol, getQuarterSymbolClass, getQuarterColor,
                    syncToCloud, openSaveModal, toggleSaveProject, selectAllSave, syncSelectedToCloud,
                    syncFromCloud, loadSelectedCloudProject, loadSelectedProjects, toggleLoadProject, selectAllLoad, deleteCloudProject,
                    downloadJsonBackup, uploadJsonRestore, clearAllData, openReport,
                    importExcelData,
                    printReport: () => window.print(),
                    captureReport: async () => {
                        const el = document.getElementById('report-print-area');
                        const canvas = await html2canvas(el, { scale: 2 });
                        const a = document.createElement('a');
                        a.href = canvas.toDataURL();
                        a.download = `RentalAssetReport_${selectedYear.value}.png`;
                        a.click();
                    }
                };
            }
        }).mount('#app');

        // Sidebar Toggle
        window.toggleSidebar = function () {
            document.body.classList.toggle('sidebar-collapsed');
            const btn = document.getElementById('btn-toggle-sidebar');
            if (document.body.classList.contains('sidebar-collapsed')) {
                btn.innerText = "‚ñ∂";
            } else {
                btn.innerText = "‚óÄ";
            }
            setTimeout(() => window.dispatchEvent(new Event('resize')), 300);
        };
    </script>
</body>

</html>